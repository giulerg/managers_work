# managers_work

Подключиться к бд PostgreSQL (данные об ответах менеджеров в сделках в amoCRM)
Необходимо:

Написать SQL-запрос, который будет рассчитывать среднее время ответа для каждого менеджера/пары менеджеров.
Расчёт должен учитывать следующее:


если в диалоге идут несколько сообщений подряд от клиента или менеджера, то при расчёте времени ответа надо учитывать только первое сообщение из каждого блока;
менеджеры работают с 09:30 до 00:00, поэтому нерабочее время не должно учитываться в расчёте среднего времени ответа, т.е. если клиент написал в 23:59, а менеджер ответил в 09:30 – время ответа равно одной минуте;
ответы на сообщения, пришедшие ночью также нужно учитывать.


Написать аналогичный запрос при помощи Python и библиотеки pandas
Построить дашборд в DataLens с данными о среднем времени ответа менеджеров. Виды визуализаций и структура отчёта произвольные, однако необходима возможность фильтровать данные по дням, менеджерам и начальникам отделов продаж.

Доступ к базе

Хост: rc1a-p8bp15mmxsfwpbt0.mdb.yandexcloud.net
Логин: test_user
Пароль: j2M{CnnFq@
База: db1
Порт: 6432
